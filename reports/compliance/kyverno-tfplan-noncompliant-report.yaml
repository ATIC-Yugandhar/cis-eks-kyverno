Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 6 policies ) ...
- cis-2-1-1-enable-audit-logs / eks-audit-logging /  FAILED
-> EKS cluster must have audit logging enabled.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.enabled_cluster_log_types && contains(values.enabled_cluster_log_types, 'audit')]) > `0`): Invalid value: false: Expected value: true
- cis-5-3-1-encrypt-secrets-kms / eks-secrets-encryption /  FAILED
-> EKS cluster must have encryption_config for secrets (KMS key may be computed at apply time).
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.encryption_config && length(values.encryption_config[?contains(resources, 'secrets')]) > `0`]) > `0`): Invalid value: false: Expected value: true
- cis-5-4-2-private-endpoint / eks-private-endpoint /  FAILED
-> EKS cluster must have endpoint_public_access=false and endpoint_private_access=true.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.vpc_config && length(values.vpc_config[?endpoint_public_access==`false` && endpoint_private_access==`true`]) > `0`]) > `0`): Invalid value: false: Expected value: true
- cis-5-4-3-private-nodes / eks-nodegroup-private-subnets /  PASSED
- cis-5-4-4-network-policy / require-network-policy /  FAILED
-> At least one kubernetes_network_policy resource should be present.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='kubernetes_network_policy']) > `0`): Invalid value: false: Expected value: true
Done
