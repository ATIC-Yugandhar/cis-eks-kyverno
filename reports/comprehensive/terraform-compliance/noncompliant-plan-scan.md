# 📊 Kyverno Terraform Plan Compliance Report - Noncompliant Configuration

**Generated on**: Sat May 24 13:38:11 IST 2025
**Total Policies**: 6

## 🎯 Executive Summary

| Metric | Value |
|--------|-------|
| **Total Policies** | 6 |
| **✅ Successful Scans** | 6 |
| **❌ Failed Scans** | 0 |
| **Success Rate** | 100.0% |

## 📋 Detailed Test Results

### Policy: `cis-5.3.1-encrypt-secrets-kms.yaml` (1/6 - 16%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
- cis-5-3-1-encrypt-secrets-kms / eks-secrets-encryption /  FAILED: -> EKS cluster must have encryption_config for secrets (KMS key may be computed at apply time).
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.encryption_config && length(values.encryption_config[?contains(resources, 'secrets')]) > `0`]) > `0`): Invalid value: false: Expected value: true
Done
```\n
---\n
### Policy: `cis-5.4.2-private-endpoint.yaml` (2/6 - 33%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
- cis-5-4-2-private-endpoint / eks-private-endpoint /  FAILED: -> EKS cluster must have endpoint_public_access=false and endpoint_private_access=true.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.vpc_config && length(values.vpc_config[?endpoint_public_access==`false` && endpoint_private_access==`true`]) > `0`]) > `0`): Invalid value: false: Expected value: true
Done
```\n
---\n
### Policy: `cis-5.4.4-network-policy.yaml` (3/6 - 50%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
- cis-5-4-4-network-policy / require-network-policy /  FAILED: -> At least one kubernetes_network_policy resource should be present.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='kubernetes_network_policy']) > `0`): Invalid value: false: Expected value: true
Done
```\n
---\n
### Policy: `cis-5.4.3-private-nodes.yaml` (4/6 - 66%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
- cis-5-4-3-private-nodes / eks-nodegroup-private-subnets /  PASSED
Done
```\n
---\n
### Policy: `require-tags.yaml` (5/6 - 83%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
Done
```\n
---\n
### Policy: `cis-2.1.1-enable-audit-logs.yaml` (6/6 - 100%)
\n```
Loading policies ...
Loading payload ...
Pre processing ...
Running ( evaluating 1 resource against 1 policy ) ...
- cis-2-1-1-enable-audit-logs / eks-audit-logging /  FAILED: -> EKS cluster must have audit logging enabled.
 -> all[0].check.(length(planned_values.root_module.resources[?type=='aws_eks_cluster' && values.enabled_cluster_log_types && contains(values.enabled_cluster_log_types, 'audit')]) > `0`): Invalid value: false: Expected value: true
Done
```\n
---\n
