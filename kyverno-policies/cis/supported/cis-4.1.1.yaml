# kyverno-policies/cis/cis-4.1.1.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: cis-4.1.1-restrict-clusteradmin-rolebindings
  annotations:
    policies.kyverno.io/title: Restrict cluster-admin RoleBindings
    policies.kyverno.io/category: CIS EKS Benchmarks
    policies.kyverno.io/severity: medium
    policies.kyverno.io/subject: ClusterRoleBinding
    policies.kyverno.io/minversion: 1.6.0
    policies.kyverno.io/description: >-
      The cluster-admin role allows superuser access to perform any action on any resource.
      This role should only be used where required. This policy audits ClusterRoleBindings
      that grant the cluster-admin role.
    policies.kyverno.io/benchmark: cis-eks
    policies.kyverno.io/controls: "4.1.1"
spec:
  validationFailureAction: Audit
  background: true
  rules:
    - name: restrict-clusteradmin-rolebindings
      match:
        any:
        - resources:
            kinds:
              - ClusterRoleBinding
      validate:
        message: "Binding to the cluster-admin role is discouraged (CIS 4.1.1)."
        pattern:
          roleRef:
            name: "!cluster-admin"