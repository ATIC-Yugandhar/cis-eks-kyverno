# kyverno-policies/cis/cis-4.2.2-test.yaml
name: cis-4.2.2-disallow-host-pid-test
policies:
  - cis-4.2.2.yaml
resources:
  # Pass case 1: hostPID not specified (defaults to false)
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-pass-hostpid-implicit
    spec:
      # hostPID implicitly false
      containers:
      - name: nginx
        image: nginx
  # Pass case 2: hostPID explicitly false
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-pass-hostpid-false
    spec:
      hostPID: false # Compliant
      containers:
      - name: nginx
        image: nginx
  # Fail case: hostPID explicitly true
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-fail-hostpid-true
    spec:
      hostPID: true # Non-compliant
      containers:
      - name: nginx
        image: nginx
results:
  - policy: cis-4.2.2-disallow-host-pid
    rule: disallow-host-pid
    resource: pod-pass-hostpid-implicit
    kind: Pod
    result: pass
  - policy: cis-4.2.2-disallow-host-pid
    rule: disallow-host-pid
    resource: pod-pass-hostpid-false
    kind: Pod
    result: pass
  - policy: cis-4.2.2-disallow-host-pid
    rule: disallow-host-pid
    resource: pod-fail-hostpid-true
    kind: Pod
    result: fail