# kyverno-policies/cis/cis-3.2.2-test.yaml
name: cis-3.2.2-audit-authorization-mode-test
policies:
  - cis-3.2.2.yaml
resources:
  - kind: AWSAdapterConfig # Hypothetical resource kind
    apiVersion: example.com/v1 # Hypothetical API version
    metadata:
      name: eks-cluster-config-pass
    spec:
      apiServer:
        authorizationMode: RBAC # Compliant mode
  - kind: AWSAdapterConfig # Hypothetical resource kind
    apiVersion: example.com/v1 # Hypothetical API version
    metadata:
      name: eks-cluster-config-fail
    spec:
      apiServer:
        authorizationMode: AlwaysAllow # Non-compliant mode
results:
  - policy: cis-3.2.2-audit-authorization-mode
    rule: audit-authorization-mode-via-adapter
    resource: eks-cluster-config-pass
    kind: AWSAdapterConfig
    result: pass
  - policy: cis-3.2.2-audit-authorization-mode
    rule: audit-authorization-mode-via-adapter
    resource: eks-cluster-config-fail
    kind: AWSAdapterConfig
    result: fail