# kyverno-policies/cis/cis-4.2.3-test.yaml
name: cis-4.2.3-disallow-host-ipc-test
policies:
  - cis-4.2.3.yaml
resources:
  # Pass case 1: hostIPC not specified (defaults to false)
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-pass-hostipc-implicit
    spec:
      # hostIPC implicitly false
      containers:
      - name: nginx
        image: nginx
  # Pass case 2: hostIPC explicitly false
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-pass-hostipc-false
    spec:
      hostIPC: false # Compliant
      containers:
      - name: nginx
        image: nginx
  # Fail case: hostIPC explicitly true
  - apiVersion: v1
    kind: Pod
    metadata:
      name: pod-fail-hostipc-true
    spec:
      hostIPC: true # Non-compliant
      containers:
      - name: nginx
        image: nginx
results:
  - policy: cis-4.2.3-disallow-host-ipc
    rule: disallow-host-ipc
    resource: pod-pass-hostipc-implicit
    kind: Pod
    result: pass
  - policy: cis-4.2.3-disallow-host-ipc
    rule: disallow-host-ipc
    resource: pod-pass-hostipc-false
    kind: Pod
    result: pass
  - policy: cis-4.2.3-disallow-host-ipc
    rule: disallow-host-ipc
    resource: pod-fail-hostipc-true
    kind: Pod
    result: fail